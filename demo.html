<html xmlns="http://www.w3.org/1999/xhtml">
<meta charset="UTF-8">
<head>
    <style>
        body{
            background-color:#fff;
            margin: 0px;
            height: 100%;
            overflow: hidden;
			font-family:"Segoe UI";
        }
        #lottie{
            background-color:transparent;
            width:40%;
            height:50%;
            display:block;
            overflow: hidden;
            transform: translate3d(0,0,+1);
            text-align: center;
			z-index:-1;
            opacity: 1;
        }
		
		.button {
		opacity: 1;
		transition: opacity 1s; 
		position:absolute; 
		display: inline-block;
		left:44%;top:39%;
		padding: 15px 25px;
		font-size: 20px;
		cursor: pointer;
		z-index:1;
		text-align: center;
	    font-weight: bold;
		text-decoration: none;
		outline: none;
		color: #fff;
		background-color: #F523B1;
		border: none;
		border-radius: 15px;
		box-shadow: 0 9px #C41C8E;
		}

		.button:hover {background-color: #EA69C0}

		.button:active {
		background-color: #F523B1;
		box-shadow: 0 5px #C41C8E;
		transform: translateY(4px);
		}




    </style>
</head>
<body>
<script type="text/javascript" src="lottie.js"></script>
<script type="text/javascript" src="slots.json"></script>
<p></p>
<center>

<div id="lottie"  style="margin-top:-5">





</div>



<div>

<button class="button" id="playbtn" onclick="animatingGame()">PLAY GAME</button>
<p></p>
win : <input type="text" id="win_data" value="12" size="1">
</div>
<center>



<script>

	var winData;
	// pool of hardcoded values - if you want to add or remove - pass the length of the array as a argument in slotsTxt
	var hardValues = [12,23,66,3,45,6,19,59];
	
	var buttonPlay = document.getElementById("playbtn");
	
	//lottie settings
   var params = {
        container: document.getElementById('lottie'),
        renderer: 'svg',
        loop: false,
        autoplay: false,
        animationData: gameJSON //this value stores the json data from the json file. it is defined in the json file.
    };


	
	//init the animation
    var anim = lottie.loadAnimation(params);
	
	/* reset animation with randomise starting values from the pool of hardcoded values 
	   if the json file is preloaded - this destruction can be avoided */
	slotTxt();
	anim.destroy();
	params.animationData = gameJSON; 
	anim = lottie.loadAnimation(params);
	
	function animatingGame(){
	
	//get wining data from database or in this case from the input
	winData = document.getElementById("win_data").value;
	/*
	set winning data to the last text layers from after effects
	first param is the index of the text layer in after effects 
	second param is the new text 
	*/
	textAE(22,winData+"%");
	textAE(20,winData+"%");
	textAE(18,winData+"%");
	
	//reset animation 
	anim.destroy();
	
	//pass the new animation with the winning data and play it
	params.animationData = gameJSON; 
    anim = lottie.loadAnimation(params);
	anim.play();
	
	//set new random values to slots for a new game;
	slotTxt();
	
	
	}
	
	/*
	function for manipulating text values of after effects layers
	first argument is the layer number in after effects
	second argument is the value  */

	function textAE(n,val){
	//the path to the text prop in the json file - it represents the layer tree in after effects
	return gameJSON.layers[1].layers[n].t.d.k[0].s.t = val;
	}

	//picks a random value for the other text values from the pool of hardcoded values
	function slotTxt(n=8){
	//set random values to the text layers in after effects
	for(let t = 16; t>=0; t-=2){
	textAE(t,hardValues[Math.floor((Math.random() * n))] + "%");
		}	
	}

	
</script>
</body>
</html>

