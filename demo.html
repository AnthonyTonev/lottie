<html xmlns="http://www.w3.org/1999/xhtml">
<meta charset="UTF-8">
<head>
    <style>
        body{
            background-color:#fff;
            margin: 0px;
            height: 100%;
            overflow: hidden;
			font-family:"Segoe UI";
        }
        #lottie{
            background-color:transparent;
            width:50%;
            height:50%;
            display:block;
            overflow: hidden;
            transform: translate3d(0,0,+1);
            text-align: center;
			z-index:-1;
            opacity: 1;
        }
		     #win{
			  position:absolute; 
			 left:25%;top:-2%;
            background-color:transparent;
            width:50%;
            height:50%;
            display:block;
            overflow: hidden;
            transform: translate3d(0,0,-1);
            text-align: center;
			z-index:1;
            opacity: 1;
        }
		     #bg{
			  position:absolute; 
			 left:25%;top:0px;
            background-color:transparent;
            width:50%;
            height:50%;
            display:block;
            overflow: hidden;
            transform: translate3d(0,0,-1);
            text-align: center;
			z-index:-1;
            opacity: 1;
        }
		
		.button {
		opacity: 1;
		transition: opacity 1s; 
		 position:absolute; 
		display: inline-block;
		 left:45.5%;top:39%;
		padding: 15px 25px;
		font-size: 20px;
		cursor: pointer;
		z-index:1;
		text-align: center;
		  font-weight: bold;
		text-decoration: none;
		outline: none;
		color: #fff;
		background-color: #F523B1;
		border: none;
		border-radius: 15px;
		box-shadow: 0 9px #C41C8E;
		}

		.button:hover {background-color: #EA69C0}

		.button:active {
		background-color: #F523B1;
		box-shadow: 0 5px #C41C8E;
		transform: translateY(4px);
		}

#playbtn {
  opacity: 1;
  transition: opacity 1s; 
}

#playbtn.fade {
  opacity: 0;
}



#lottie {
  opacity: 1;
  transition: opacity 1s; 
}

#lottie.fade {
  opacity: 0;
}




    </style>
</head>
<body>
<script type="text/javascript" src="lottie.js"></script>
<script type="text/javascript" src="bg.json"></script>
<script type="text/javascript" src="start.json"></script>
<script type="text/javascript" src="victory.json"></script>
<center>
<div id="bg"  style="margin-top:-5"></div>
<div id="lottie"  style="margin-top:-5"></div>

<div id="win"  style="margin-bottom:-900px;"></div>

<button class="button" id="playbtn" onclick="animatingGame()">PLAY GAME</button>
<p></p>
<div >
win : <input type="text" id="percent" value="12" size="1">
<p></p>
Discount Code : <input type="text" id="discount" value="Join WooHoo!" size="12">
</div>
<center>



<script>

	var winData;
	var discountCode;
	// pool of hardcoded values
	var hardValues = [12,23,66,3,45,6,19,59,16,34];

	//lottie settings
   var params = {
        container: document.getElementById('lottie'),
        renderer: 'svg',
        loop: false,
        autoplay: false,
        animationData: startJSON
    };
	
	   var vicPara = {
        container: document.getElementById('win'),
        renderer: 'svg',
        loop: false,
        autoplay: false,
        animationData: victoryJSON
    };
	
	
	 var bgpara = {
        container: document.getElementById('bg'),
        renderer: 'svg',
        loop: false,
        autoplay: false,
        animationData: bgJSON
    };
	
	//init the animation
	var bg = lottie.loadAnimation(bgpara);
    var anim = lottie.loadAnimation(params);
	var victoryScreen = lottie.loadAnimation(vicPara);
	var buttonPlay = document.getElementById("playbtn");
	//reset animation with randomise starting values from the pool of hardcoded values 
	otherTxt();
	anim.destroy();
	params.animationData = startJSON;
	anim = lottie.loadAnimation(params);
	
	function animatingGame(){
	//get wining data from database
	winData = document.getElementById("percent").value;
	discountCode =  document.getElementById("discount").value;
	//set winning data to the last text layers from after effects
	textAE(22,winData+"%");
	textAE(20,winData+"%");
	textAE(18,winData+"%");
	
	//reset animation with winning value
	params.animationData = startJSON;
	anim.destroy();
    anim = lottie.loadAnimation(params);
	anim.play();
	otherTxt();
	
	victoryJSON.layers[6].t.d.k[0].s.t = winData+"%";
	victoryJSON.layers[8].t.d.k[0].s.t = discountCode;
	vicPara.animationData = victoryJSON;
	victoryScreen.destroy();
	victoryScreen = lottie.loadAnimation(vicPara);

	setTimeout(() => {
	
	buttonPlay.disabled=true;
	buttonPlay.style = "background-color: LightGray;box-shadow: 0 9px gray";
	
	}, 100);
	clearTimeout();
	
	setTimeout(() => {
	
	
		params.container.classList.toggle('fade');
	  buttonPlay.classList.toggle('fade');
	victoryScreen.play();
	

	}, 3000);
	clearTimeout();
	
	
	}

	//function for manipulating text values of after effects layers
	function textAE(n,val){
	return startJSON.layers[1].layers[n].t.d.k[0].s.t = val;
	}

	//randomising the other text values from the pool of hardcoded values	
	function otherTxt(){
	for(let t = 16; t>=0; t-=2){
	textAE(t,hardValues[Math.floor((Math.random() * 10))] + "%");
		}	
	}

	

	
	
	
</script>
</body>
</html>


















